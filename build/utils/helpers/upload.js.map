{"version":3,"sources":["../../../src/utils/helpers/upload.js"],"names":["storage","GridFsStorage","url","process","env","DB_URL","options","useNewUrlParser","useUnifiedTopology","file","req","match","indexOf","mimetype","filename","Date","now","originalname","bucketName"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,MAAMA,OAAO,GAAG,IAAIC,4BAAJ,CAAkB;AAC9BC,EAAAA,GAAG,EAAEC,OAAO,CAACC,GAAR,CAAYC,MADa;AAE9BC,EAAAA,OAAO,EAAE;AAAEC,IAAAA,eAAe,EAAE,IAAnB;AAAyBC,IAAAA,kBAAkB,EAAE;AAA7C,GAFqB;AAG9BC,EAAAA,IAAI,EAAE,CAACC,GAAD,EAAMD,IAAN,KAAe;AACjB,UAAME,KAAK,GAAG,CAAC,WAAD,EAAc,YAAd,CAAd;;AAEA,QAAIA,KAAK,CAACC,OAAN,CAAcH,IAAI,CAACI,QAAnB,MAAiC,CAAC,CAAtC,EAAyC;AACrC,YAAMC,QAAQ,GAAI,GAAEC,IAAI,CAACC,GAAL,EAAW,aAAYP,IAAI,CAACQ,YAAa,EAA7D;AACA,aAAOH,QAAP;AACH;;AAED,WAAO;AACHI,MAAAA,UAAU,EAAE,QADT;AAEHJ,MAAAA,QAAQ,EAAG,GAAEC,IAAI,CAACC,GAAL,EAAW,aAAYP,IAAI,CAACQ,YAAa;AAFnD,KAAP;AAIH;AAf6B,CAAlB,CAAhB;eAkBejB,O","sourcesContent":["import multer from \"multer\";\nimport GridFsStorage from \"multer-gridfs-storage\";\n\nconst storage = new GridFsStorage({\n    url: process.env.DB_URL,\n    options: { useNewUrlParser: true, useUnifiedTopology: true },\n    file: (req, file) => {\n        const match = [\"image/png\", \"image/jpeg\"];\n\n        if (match.indexOf(file.mimetype) === -1) {\n            const filename = `${Date.now()}-any-name-${file.originalname}`;\n            return filename;\n        }\n\n        return {\n            bucketName: \"photos\",\n            filename: `${Date.now()}-any-name-${file.originalname}`,\n        };\n    },\n});\n\nexport default storage;\n"],"file":"upload.js"}