{"version":3,"sources":["../../src/routes/index.js"],"names":["routes","require","Router","jwt","multer","cookieParser","path","bodyParser","uuid","fs","AWS","use","urlencoded","extended","json","s3","S3","accessKeyId","secretAccessKey","get","req","res","status","message","route","post","body","models","userModel","create","address","toLowerCase","error","console","log","put","userFromDB","findOne","updateOne","runValidators","query","user","lean","exec","VerifiedCollection","findOneAndUpdate","isVerified","isverified","err","find","data","existingOne","collectionModel","name","tokenUpdate","$push","parseInt","tokens","send","owner","nftAddress","avatar","background","description","externalUrl","toString","_id","Error","collection","delete","findOneAndDelete","featureCollectionPath","join","__dirname","Storage","diskStorage","destination","filename","file","cb","v4","extname","originalname","uploadcoll","storage","single","undefined","link","readFile","params","Bucket","Key","ACL","ContentType","mimetype","Body","upload","filterFeatureCollection","uploadfeaturemodel","collection_name","imageUrl","Location","profilefilePath","uploadImage","fname","s3Err","collections","select","token","$and","tokenAddr","tokenId","obj","viewAndLikeModel","views","likes","likedAccounts","viewedAddresses","includes","new","newUpdatedInfo","viewAndLike","then","catch","likedNft","like","userAddress","forEach","nftdata","nftControllerModel","nft","push","setTimeout","viewedNft","view","follower","following","followers","map","userdata","fdata","msg","followings","account","createAdmin","adminRegisterModel","walletAddress","save","adminData","sign","cookie","expires","Date","now","filterData","updateNft","price","ownerOf","createNft","metadata","selectedCat","tokenUri","chainId","relatedCollectionId","$regex","$options","countDocuments","count","limitedNft","skip","page","size","limit","totalPage","Math","ceil","featured","documents","isFeatured","category","filePath","uploadSliderModel","uploadslider","id","url","q","split","deleteSlider","deleteObject","users","userName","module","exports"],"mappings":"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aAAJ,EAAmBE,QAAnB,CAA4B5F,IAAI,CAACI,OAAjC,CAAJ,EAA+C;AAC7C,gBAAM,IAAIqC,KAAJ,CAAU,eAAV,CAAN;AACD,SAFD,CAGA;AAHA,aAIK;AACH,gBAAMxC,gBAAOsF,gBAAP,CAAwBpE,gBAAxB,CACJ;AAAEiE,YAAAA,SAAS,EAAEpF,IAAI,CAACoF,SAAlB;AAA6BC,YAAAA,OAAO,EAAErF,IAAI,CAACqF;AAA3C,WADI,EAEJ;AAAEK,YAAAA,aAAa,EAAE,CAAC,GAAGJ,GAAG,CAACI,aAAR,EAAuB1F,IAAI,CAACI,OAA5B;AAAjB,WAFI,EAGJ;AAAEyF,YAAAA,GAAG,EAAE;AAAP,WAHI,CAAN;AAKD;AACF,OAtCM,CAwCP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,YAAMC,cAAc,GAAG,MAAM7F,gBAAOsF,gBAAP,CAAwBpE,gBAAxB,CAC3B;AAAEiE,QAAAA,SAAS,E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","sourcesContent":["import models from \"~/models\";\r\nconst routes = require(\"express\").Router();\r\nconst jwt=require(\"jsonwebtoken\")\r\nconst multer = require(\"multer\");\r\nvar cookieParser = require('cookie-parser')\r\nconst path=require(\"path\");\r\nconst bodyParser=require(\"body-parser\");\r\nvar uuid = require('uuid');\r\nconst fs = require('fs');\r\nconst AWS = require('aws-sdk')\r\n\r\nroutes.use(cookieParser())\r\n\r\n// Body Parsers\r\nroutes.use(bodyParser.urlencoded({ extended: false }));\r\nroutes.use(bodyParser.json());\r\n\r\nconst s3 = new AWS.S3({\r\n  accessKeyId: \"AKIASAFVMRRSMD5RISOV\",\r\n  secretAccessKey: \"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\"\r\n});\r\n\r\nroutes.get(\"/\", (req, res) => {\r\n  res.status(200).json({ message: \"Connected!\" });\r\n});\r\n\r\nroutes\r\n  .route(\"/profile\")\r\n  .post(async (req, res) => {\r\n    try {\r\n      const { body } = req;\r\n      await models.userModel.create({\r\n        ...body,\r\n        address: body.address.toLowerCase(),\r\n      });\r\n      res.status(200).json(\"Successfully registered\");\r\n    } catch (error) {\r\n      console.log(\"[profile post] error => \", error);\r\n      res.status(500).json({ message: \"Server Error\" });\r\n    }\r\n  })\r\n  .put(async (req, res) => {\r\n    try {\r\n      const { body } = req;\r\n      const userFromDB = await models.userModel.findOne({\r\n        address: body.address.toLowerCase(),\r\n      });\r\n      if (userFromDB) {\r\n        await models.userModel.updateOne(\r\n          { address: body.address.toLowerCase() },\r\n          { ...body, address: body.address.toLowerCase() },\r\n          { runValidators: true }\r\n        );\r\n        res.status(200).json(\"Successfully updated\");\r\n      } else {\r\n        res.status(500).json({ message: \"User not registered yet.\" });\r\n      }\r\n    } catch (error) {\r\n      console.log(\"[profile post] error => \", error);\r\n      res.status(500).json({ message: \"Server Error\" });\r\n    }\r\n  })\r\n  .get(async (req, res) => {\r\n    const address = req.query.address;\r\n    const user = await models.userModel\r\n      .findOne({ address: address.toLowerCase() })\r\n      .lean()\r\n      .exec();\r\n    res.status(200).json({ ...user });\r\n  });\r\n\r\n  routes.post(\"/verified_user\",(req,res)=>{\r\n    let VerifiedCollection= models.userModel.findOneAndUpdate({address:req.body.address},{\r\n      isVerified: req.body.isverified\r\n    })\r\n    VerifiedCollection.exec((err)=>{\r\n      if(err) throw err;\r\n      res.status(200).json({message:\"Successfully Verified\"})\r\n    })\r\n  })\r\n\r\nroutes.get(\"/get-all-users\", (req, res) => {\r\n    let user = models.userModel.find();\r\n    user.exec((err,data)=>{\r\n      res.status(200).json({data});\r\n    })\r\n});\r\n\r\nroutes\r\n  .route(\"/collection\")\r\n  .post(async (req, res) => {\r\n    try {\r\n      const { body } = req;\r\n      const existingOne = await models.collectionModel.findOne({\r\n        name: body.name,\r\n      });\r\n      \r\n      if (existingOne) {\r\n        let tokenUpdate=models.collectionModel.findOneAndUpdate({name: body.name},{\r\n          $push: {'tokens': parseInt(body.tokens)}\r\n        })\r\n        tokenUpdate.exec((err)=>{\r\n          if(err) throw err;\r\n          res.send(\"Successfully token Added!\")\r\n        })\r\n      }\r\n      else{\r\n        await models.collectionModel.create({\r\n          name: body.name,\r\n          owner: body.owner?.toLowerCase(),\r\n          nftAddress: body.nftAddress?.toLowerCase(),\r\n          avatar: body.avatar,\r\n          background: body.background,\r\n          description: body.description,\r\n          externalUrl: body.externalUrl,\r\n          tokens: parseInt(body.tokens) || [],\r\n        });\r\n        res.status(200).json(\"Successfully created!\");\r\n      }\r\n    } catch (error) {\r\n      console.log(\"[collection post] error => \", error);\r\n      res.status(500).json({ message: error.toString() });\r\n    }\r\n  })\r\n  .put(async (req, res) => {\r\n    try {\r\n      const { body } = req;\r\n      console.log(\"aj : **** body => \", body);\r\n      const existingOne = await models.collectionModel.findOne({\r\n        _id: body._id,\r\n      });\r\n      if (!existingOne) {\r\n        throw new Error(\"No exist id\");\r\n      }\r\n      let data = {\r\n        name: body.name?.toLowerCase(),\r\n      };\r\n      if (!!body.avatar) {\r\n        data = { ...data, avatar: body.avatar };\r\n      }\r\n      if (!!body.background) {\r\n        data = { ...data, background: body.background };\r\n      }\r\n      if (!!body.description) {\r\n        data = { ...data, description: body.description };\r\n      }\r\n      if (!!body.externalUrl) {\r\n        data = { ...data, externalUrl: body.externalUrl };\r\n      }\r\n      if (!!body.tokens) {\r\n        data = { ...data, tokens: body.tokens };\r\n      }\r\n      await models.collectionModel.updateOne({ _id: body._id }, data);\r\n      res.status(200).json(\"Successfully updated!\");\r\n    } catch (error) {\r\n      console.log(\"[collection put] error => \", error);\r\n      res.status(500).json({ message: error.toString() });\r\n    }\r\n  })\r\n  .get(async (req, res) => {\r\n    try {\r\n      const name = req.query.name;\r\n      const collection = await models.collectionModel\r\n        .findOne({ name })\r\n        .lean()\r\n        .exec();\r\n      res.status(200).json({ ...collection });\r\n    } catch (error) {\r\n      console.log(\"[collection get] error => \", error);\r\n      res.status(500).json({ message: error.toString() });\r\n    }\r\n  })\r\n  .delete(async (req, res) => {\r\n    try {\r\n      const { body } = req;\r\n      const existingOne = await models.collectionModel.findOneAndDelete({\r\n        _id: body._id,\r\n      });\r\n      return res.status(200).json(\"Successfully deleted\");\r\n    } catch (error) {\r\n      console.log(\"[collection delete] error => \", error);\r\n    }\r\n  });\r\n\r\n  const featureCollectionPath = path.join(__dirname,\"../\",\"../public/featureCollectionImage/\");\r\n\r\n  // for file upload\r\n  var Storage=multer.diskStorage({\r\n    destination:featureCollectionPath,\r\n    filename:(req,file,cb)=>{\r\n      cb(null,uuid.v4()+path.extname(file.originalname))\r\n    }\r\n  })\r\n  \r\n  var uploadcoll=multer({\r\n    storage:Storage\r\n  }).single('pic');\r\n   \r\n  routes.post(\"/feature_collection\",uploadcoll,(req,res)=>{\r\n    if(req.file == undefined){\r\n      res.status(400).json({message:\"Image is Required\"})\r\n    }\r\n    else if(req.body.link == undefined){\r\n      res.status(400).json({message:\"Link is Required\"})\r\n    }\r\n    else{\r\n    fs.readFile(req.file.path, (err, data) => {\r\n      if (err) throw err;\r\n      const params = {\r\n          Bucket: 'closedsea', // pass your bucket name\r\n          Key: req.file.filename, // file will be saved as testBucket/contacts.csv\r\n          ACL: \"public-read\",\r\n          ContentType: req.file.mimetype,\r\n          Body: data\r\n      };\r\n      s3.upload(params, function(err, data) {\r\n          if (err) throw err\r\n          let filterFeatureCollection= models.uploadfeaturemodel.findOneAndUpdate({collection_name:req.body.collection},{\r\n            link: req.body.link,\r\n            imageUrl:data.Location\r\n          })\r\n          filterFeatureCollection.exec((err)=>{\r\n            if(err) throw err;\r\n            res.status(200).json({message:\"Success\"})\r\n          })\r\n      });\r\n   });\r\n  }\r\n  });\r\n\r\n  routes.get(\"/feature_collection\", async (req, res) => {\r\n    models.uploadfeaturemodel.find((err,data)=>{\r\n      if(err) throw err;\r\n      res.status(200).json({data})\r\n    })\r\n  })\r\n\r\n  routes.post(\"/verified_collection\",(req,res)=>{\r\n    let VerifiedCollection= models.collectionModel.findOneAndUpdate({name:req.body.collection_name},{\r\n      isVerified: req.body.isverified\r\n    })\r\n    VerifiedCollection.exec((err)=>{\r\n      if(err) throw err;\r\n      res.status(200).json({message:\"Successfully Verified\"})\r\n    })\r\n  })\r\nconst profilefilePath = path.join(__dirname,\"../\",\"../public/commonimage/\");\r\n\r\n// for file upload\r\nvar Storage=multer.diskStorage({\r\n  destination:profilefilePath,\r\n  filename:(req,file,cb)=>{\r\n    cb(null,uuid.v4()+path.extname(file.originalname))\r\n  }\r\n})\r\n\r\nvar uploadImage=multer({\r\n  storage:Storage\r\n}).single('file');\r\n \r\nroutes.post(\"/upload_file_to_s3\",uploadImage,(req,res)=>{\r\n  if(req.file == undefined){\r\n    res.status(\"400\").json({message:\"Image is Required\"})\r\n  }\r\n  else{\r\n      fs.readFile(req.file.path, (err, data) => {\r\n        if (err) throw err;\r\n        const params = {\r\n            Bucket: 'closedsea', // pass your bucket name\r\n            Key: req.body.fname, // file will be saved\r\n            ACL: \"public-read\",\r\n            ContentType: req.file.mimetype,\r\n            Body: data\r\n        };\r\n        s3.upload(params, function(s3Err, data) {\r\n            if (s3Err) throw s3Err\r\n            res.status(200).json(data);\r\n        });\r\n      });\r\n    }\r\n})\r\n\r\nroutes.get(\"/collection-names\", async (req, res) => {\r\n  try {\r\n    const collections = await models.collectionModel\r\n      .find({})\r\n      .select(\"name -_id\")\r\n      .exec();\r\n    res.status(200).json(collections);\r\n  } catch (error) {\r\n    console.log(\"[collection names] get error => \", error);\r\n    res.status(500).json({ message: error.toString() });\r\n  }\r\n});\r\n\r\nroutes.get(\"/my-collections\", async (req, res) => {\r\n  try {\r\n    const owner = req.query.owner?.toLowerCase();\r\n    const token = req.query.token;\r\n    if(owner && token){\r\n      const collections = await models.collectionModel.find({$and:[ {owner:owner},{tokens:parseInt(token)} ]}).lean().exec();\r\n      res.status(200).json(collections);\r\n    }\r\n    else if(owner){\r\n      const collections = await models.collectionModel.find({ owner }).lean().exec();\r\n      res.status(200).json(collections);\r\n    }\r\n    else{\r\n      res.status(400).json({message:\"Required value not found\"});\r\n    }\r\n  } catch (error) {\r\n    console.log(\"[collection names] get error => \", error);\r\n    res.status(500).json({ message: error.toString() });\r\n  }\r\n});\r\n\r\nroutes.put(\"/insert-token-to-collection\", async (req, res) => {\r\n  try {\r\n    const { body } = req;\r\n    const collection = await models.collectionModel\r\n      .find({ name: body.name })\r\n      .lean()\r\n      .exec();\r\n    if (collection) {\r\n      let tokenUpdate=models.collectionModel.findOneAndUpdate({name: body.name},{\r\n        $push: {'tokens': parseInt(body.token)}\r\n      })\r\n      tokenUpdate.exec((err)=>{\r\n        if(err) throw err;\r\n        res.status(200).json({message:\"Successfully token Added!\"})\r\n      })\r\n    }\r\n    else{\r\n      res.status(200).json({message:\"Document not found!\"})\r\n    }\r\n  } catch (error) {\r\n    console.log(\"[collection names] get error => \", error);\r\n    res.status(500).json({ message: error.toString() });\r\n  }\r\n});\r\n\r\nroutes\r\n  .route(\"/view-and-like\")\r\n  .get(async (req, res) => {\r\n    try {\r\n      const { tokenAddr, tokenId } = req.query;\r\n\r\n      const obj = await models.viewAndLikeModel\r\n        .findOne({ tokenAddr, tokenId })\r\n        .lean()\r\n        .exec();\r\n\r\n      if (obj) {\r\n        res.status(200).json({ ...obj });\r\n      } else {\r\n        res.status(200).json({\r\n          views: 0,\r\n          likes: 0,\r\n          tokenAddr,\r\n          tokenId,\r\n          likedAccounts: [],\r\n          viewedAddresses: [],\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.log(\"[view and like] get error => \", error);\r\n      res.status(500).json({ message: error.toString() });\r\n    }\r\n  })\r\n  .post(async (req, res) => {\r\n    try {\r\n      const { body } = req;\r\n      console.log({ body });\r\n      const obj = await models.viewAndLikeModel.findOne({\r\n        tokenAddr: body.tokenAddr,\r\n        tokenId: body.tokenId,\r\n      });\r\n      console.log({ obj });\r\n      if (obj) {\r\n        // update\r\n\r\n        //VIEWS ARE NOT EQUAL ? THEN CHECK IF ADDRESS IS PRESENT IN ARRAY\r\n        if (\r\n          (parseInt(body.views) !== parseInt(obj.views) &&\r\n            parseInt(body.views) !== 0) ||\r\n          (parseInt(body.views) === parseInt(obj.views) &&\r\n            parseInt(body.views) !== 0)\r\n        ) {\r\n          if (obj.viewedAddresses?.includes(body.address)) {\r\n            throw new Error(\"Already viewed\");\r\n          } else {\r\n            await models.viewAndLikeModel.findOneAndUpdate(\r\n              { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n              { viewedAddresses: [...obj.viewedAddresses, body.address] },\r\n              { new: true }\r\n            );\r\n          }\r\n        }\r\n\r\n        if (\r\n          (parseInt(body.likes) !== parseInt(obj.likes) &&\r\n            parseInt(body.likes) !== 0) ||\r\n          (parseInt(body.likes) === parseInt(obj.likes) &&\r\n            parseInt(body.likes) !== 0)\r\n        ) {\r\n          if (obj.likedAccounts?.includes(body.address)) {\r\n            throw new Error(\"Already Liked\");\r\n          }\r\n          //else if\r\n          else {\r\n            await models.viewAndLikeModel.findOneAndUpdate(\r\n              { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n              { likedAccounts: [...obj.likedAccounts, body.address] },\r\n              { new: true }\r\n            );\r\n          }\r\n        }\r\n\r\n        // if (parseInt(body.views) === parseInt(obj.views)) {\r\n        //   if (obj.viewedAddresses?.includes(body.address)) {\r\n        //     throw new Error(\"Already viewed\");\r\n        //   } else {\r\n        //     await models.viewAndLikeModel.updateOne(\r\n        //       { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //       { viewedAddresses: [...obj.viewedAddresses, body.address] }\r\n        //     );\r\n        //   }\r\n        // }\r\n\r\n        //LIKE\r\n        // if (parseInt(body.likes) !== parseInt(obj.likes)) {\r\n        //   if (obj.viewedAddresses?.includes(body.address)) {\r\n        //     throw new Error(\"Already viewed\");\r\n        //   } else {\r\n        //     await models.viewAndLikeModel.updateOne(\r\n        //       { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //       { viewedAddresses: [...obj.viewedAddresses, body.address] }\r\n        //     );\r\n        //   }\r\n        // }\r\n        // if (parseInt(body.likes) === parseInt(obj.likes)) {\r\n        //   if (obj.viewedAddresses?.includes(body.address)) {\r\n        //     throw new Error(\"Already viewed\");\r\n        //   } else {\r\n        //     await models.viewAndLikeModel.updateOne(\r\n        //       { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //       { viewedAddresses: [...obj.viewedAddresses, body.address] }\r\n        //     );\r\n        //   }\r\n        // }\r\n\r\n        //BODY VIEWS < DB VIEWS ? 1 < 2 ? THEN CHECK THE ARRAY AND FILTER IT\r\n        // if (parseInt(body.views) < parseInt(obj.views)) {\r\n        //   console.log(\"BEFORE :\" + obj.viewedAddresses);\r\n        //   const addresses =\r\n        //     obj.viewedAddresses?.filter(\r\n        //       (v) => v !== body.address?.toLowerCase()\r\n        //     ) !== []\r\n        //       ? [...obj.viewedAddresses, body.address?.toLowerCase()]\r\n        //       : [];\r\n        // }\r\n        // else if (\r\n        //   parseInt(body.views) === parseInt(obj.views) ||\r\n        //   parseInt(body.views) === 0\r\n        // ) {\r\n        //   const addresses =\r\n        //     obj.viewedAddresses?.filter(\r\n        //       (v) => v !== body.address?.toLowerCase()\r\n        //     ) === []\r\n        //       ? [...obj.viewedAddresses]\r\n        //       : [];\r\n\r\n        //   console.log(\"I AM VIEW ADDRESS === or 0\" + addresses);\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { viewedAddresses: addresses }\r\n        //   );\r\n        // } else {\r\n        //   const addresses = [\r\n        //     ...obj.viewedAddresses,\r\n        //     body.address?.toLowerCase(),\r\n        //   ];\r\n\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { viewedAddresses: addresses }\r\n        //   );\r\n        // }\r\n\r\n        // if (parseInt(body.likes) > parseInt(obj.likes)) {\r\n        //   console.log(\"LIKES\");\r\n        //   if (obj.likedAccounts?.includes(body.address)) {\r\n        //     console.log(\"LIKE INCLUDED\");\r\n        //     throw new Error(\"Already liked\");\r\n        //   } else {\r\n        //     console.log(\"LIKE NOT INCLUDED\");\r\n        //   }\r\n        // }\r\n        // if (parseInt(body.views) < parseInt(obj.views)) {\r\n        //   const addresses =\r\n        //     obj.viewedAddresses?.filter(\r\n        //       (v) => v !== body.address?.toLowerCase()\r\n        //     ) === []\r\n        //       ? [...obj.viewedAddresses]\r\n        //       : [];\r\n        //   console.log({ addresses });\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { viewedAddresses: addresses }\r\n        //   );\r\n        // } else if (\r\n        //   parseInt(body.views) === parseInt(obj.views) ||\r\n        //   parseInt(body.views) === 0\r\n        // ) {\r\n        //   const addresses =\r\n        //     obj.viewedAddresses?.filter(\r\n        //       (v) => v !== body.address?.toLowerCase()\r\n        //     ) === []\r\n        //       ? [...obj.viewedAddresses]\r\n        //       : [];\r\n\r\n        //   console.log(\"I AM VIEW ADDRESS === or 0\" + addresses);\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { viewedAddresses: addresses }\r\n        //   );\r\n        // } else {\r\n        //   const addresses = [\r\n        //     ...obj.viewedAddresses,\r\n        //     body.address?.toLowerCase(),\r\n        //   ];\r\n\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { viewedAddresses: addresses }\r\n        //   );\r\n        // }\r\n        // if (parseInt(body.likes) < parseInt(obj.likes)) {\r\n        //   console.log(\"I AM LESS\");\r\n        //   const addresses =\r\n        //     obj.likedAccounts?.filter(\r\n        //       (v) => v !== body.address?.toLowerCase()\r\n        //     ) || [];\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { likedAccounts: addresses }\r\n        //   );\r\n        // } else if (\r\n        //   parseInt(body.likes) === parseInt(obj.likes) ||\r\n        //   parseInt(body.likes) === 0\r\n        // ) {\r\n        //   const addresses = obj.likedAccounts?.filter(\r\n        //     (v) => v !== body.address?.toLowerCase()\r\n        //   );\r\n        //   console.log({ addresses });\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { likedAccounts: addresses }\r\n        //   );\r\n        // } else {\r\n        //   console.log(\"I AM + 1\");\r\n        //   const addresses = [...obj.likedAccounts, body.address?.toLowerCase()];\r\n        //   await models.viewAndLikeModel.updateOne(\r\n        //     { tokenAddr: body.tokenAddr, tokenId: body.tokenId },\r\n        //     { likedAccounts: addresses }\r\n        //   );\r\n        // }\r\n        const newUpdatedInfo = await models.viewAndLikeModel.findOneAndUpdate(\r\n          { tokenAddr: body.tokenAddr?.toLowerCase(), tokenId: body.tokenId },\r\n          {\r\n            views: obj.views + body.views,\r\n            likes: obj.likes + body.likes,\r\n          },\r\n          { new: true }\r\n        );\r\n        res.status(200).json(newUpdatedInfo);\r\n      } else {\r\n        await models.viewAndLikeModel.create({\r\n          tokenAddr: body.tokenAddr?.toLowerCase(),\r\n          tokenId: body.tokenId,\r\n          views: body.views > 0 ? 1 : 0,\r\n          likes: body.likes > 0 ? 1 : 0,\r\n          viewedAddresses: body.views > 0 ? [body.address?.toLowerCase()] : [],\r\n          likedAccounts: body.likes > 0 ? [body.address?.toLowerCase()] : [],\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.log(\"[view and like] post error => \", error);\r\n      res.status(500).json({ message: error.toString() });\r\n    }\r\n  });\r\n\r\nroutes.get(\"/views_and_likes\",(req, res) => {\r\n    var viewAndLike=models.viewAndLikeModel.find();\r\n    viewAndLike.exec()\r\n    .then((data)=>{\r\n      res.send(data);\r\n    })\r\n    .catch((err)=>console.log(err))\r\n})\r\n\r\nroutes.post(\"/usersviews_and_userslikes\",(req, res) => {\r\n  let likedNft =[];\r\n    var like=models.viewAndLikeModel.find({likedAccounts:req.body.userAddress});\r\n    like.exec((err,data)=>{\r\n      data.forEach(function(token){\r\n        let nftdata=models.nftControllerModel.findOne({tokenId:token.tokenId});\r\n        nftdata.exec((err,nft)=>{\r\n          if (err) throw err\r\n          likedNft.push(nft)\r\n        })\r\n      })\r\n      setTimeout(()=>res.status(200).json({likedNft}),3000);\r\n    })\r\n})\r\n\r\n\r\nroutes.post(\"/usersviews\",(req, res) => {\r\n  let viewedNft =[];\r\n    var view=models.viewAndLikeModel.find({viewedAddresses:req.body.userAddress});\r\n    view.exec((err,data)=>{\r\n      data.forEach(function(token){\r\n        let nftdata=models.nftControllerModel.findOne({tokenId:token.tokenId});\r\n        nftdata.exec((err,nft)=>{\r\n          if (err) throw err\r\n          viewedNft.push(nft)\r\n        })\r\n      })\r\n      setTimeout(()=>res.status(200).json({viewedNft}),3000);\r\n    })\r\n})\r\n\r\nroutes.post(\"/users_follow\",(req, res) => {\r\n  let follower=models.userModel.findOneAndUpdate({address:req.body.follower},{\r\n    $push: {'follower': req.body.following}\r\n  })\r\n  follower.exec((err)=>{\r\n    if(err) throw err;\r\n    let following=models.userModel.findOneAndUpdate({address:req.body.following},{\r\n      $push: {'following': req.body.follower}\r\n    })\r\n    following.exec((err)=>{\r\n      if(err) throw err;\r\n      res.send(\"success\")\r\n    })\r\n  })\r\n})\r\n\r\nroutes.post(\"/get-followers\",(req, res) => {\r\n  let followers=[];\r\n    var user=models.userModel.findOne({address:req.body.userAddress});\r\n    user.exec((err,data)=>{\r\n      if(err) throw err;\r\n      if(data!==undefined && data!==null){\r\n        if(data.follower[0]!==undefined && data.follower[0]!==null){\r\n         data.follower.map(function(address){\r\n          let userdata=models.userModel.findOne({address:address});\r\n          userdata.exec((err,fdata)=>{\r\n            if (err) throw err\r\n            if(fdata!==undefined && fdata!==null){\r\n              followers.push(fdata)\r\n            }\r\n          })\r\n        })\r\n          setTimeout(()=>res.status(200).json({followers}),3000);\r\n          }\r\n        else{\r\n          res.status(400).json({msg:\"No followers\"})\r\n        }\r\n      }\r\n      else{\r\n        res.status(400).json({msg:\"No Data\"})\r\n      }\r\n    })\r\n})\r\n\r\nroutes.post(\"/get-following\",(req, res) => {\r\n  let followings=[];\r\n    var user=models.userModel.findOne({address:req.body.userAddress});\r\n    user.exec((err,data)=>{\r\n      if(err) throw err;\r\n      if(data!==undefined && data!==null){\r\n        if(data.following[0]!==undefined && data.following[0]!==null){\r\n          data.following.map(function(address){\r\n            let userdata=models.userModel.findOne({address:address});\r\n            userdata.exec((err,fdata)=>{\r\n              if (err) throw err\r\n              if(fdata!==undefined && fdata!==null){\r\n                followings.push(fdata)\r\n              }\r\n            })\r\n          })\r\n        setTimeout(()=>res.status(200).json({followings}),3000);\r\n      }\r\n      else{\r\n        res.status(400).json({msg:\"No followings\"})\r\n      }\r\n    }\r\n      else{\r\n        res.status(400).json({msg:\"No Data\"})\r\n      }\r\n  })\r\n})\r\n\r\nroutes.post(\"/admin-register\",(req, res) => {\r\n  if(req.body.account){\r\n    let createAdmin=new models.adminRegisterModel({\r\n      walletAddress: req.body.account,\r\n    })\r\n    createAdmin.save(function(){\r\n      res.send(\"Admin Stored Succcesfully\");\r\n    });\r\n  }\r\n  else{\r\n    res.status.send(\"address are empty\")\r\n  }\r\n})\r\n\r\nroutes.post(\"/admin-login\",(req, res) => {\r\n  let adminData=models.adminRegisterModel.findOne({walletAddress:req.body.account});\r\n  adminData.exec()\r\n  .then((data)=>{\r\n    if(data){\r\n      const token=jwt.sign({walletAddress:req.body.account},\"walletaddress12345678123456781234\")\r\n      res.cookie('closedSeaAdmin',token,{expires:new Date(Date.now()+6000000)})\r\n      res.status(200).send(\"Sucessfull Login\")\r\n    }\r\n    else{\r\n      res.status(400).send(\"Wallet Not Found\")\r\n    }\r\n  })\r\n  .catch((err)=>console.log(err))\r\n})\r\n\r\nroutes.get(\"/nft-collector\",(req, res) => {\r\n  var nftdata=models.nftControllerModel.find();\r\n  nftdata.exec()\r\n  .then((data)=>{\r\n    res.status(200).json(data)\r\n  })\r\n  .catch((err)=>console.log(err))\r\n})\r\n\r\nroutes.post(\"/nft-collector\",(req, res) => {\r\n  let filterData=models.nftControllerModel.findOne({tokenId: req.body.tokenId});\r\n  filterData.exec((err,data)=>{\r\n    if (err) throw err;\r\n    if(data!==null){\r\n      let updateNft= models.nftControllerModel.findOneAndUpdate({tokenId: req.body.tokenId},{\r\n        price: req.body.price,\r\n        owner:req.body.ownerOf\r\n      })\r\n      updateNft.exec((err)=>{\r\n        if(err) throw err;\r\n        res.status(200).json({message:\"Updated Success\"})\r\n      })\r\n    }\r\n    else{\r\n      let createNft=new models.nftControllerModel({\r\n        tokenAddr: req.body.tokenAddr,\r\n        tokenId: req.body.tokenId,\r\n        price: req.body.price,\r\n        owner:req.body.ownerOf,\r\n        metadata: req.body.metadata,\r\n        selectedCat:req.body.selectedCat,\r\n        tokenUri:req.body.tokenUri,\r\n        chainId:req.body.chainId,\r\n        relatedCollectionId:req.body.relatedCollectionId,\r\n        status:\"pending\"\r\n      })\r\n      createNft.save(function(){\r\n        res.status(200).json({message:\"Success\"})\r\n    });\r\n    }\r\n})\r\n\r\n})\r\n\r\nroutes.post(\"/search-nft\",(req, res) => {\r\n  console.log(req.body.name)\r\n  if (req.body.name !==undefined && req.body.name !== null && req.body.name !== false){\r\n  let filterData=models.nftControllerModel.find({\"metadata.name\": { $regex:'.*' + req.body.name + \".*\", $options: 'i'}});\r\n  filterData.exec((err,data)=>{\r\n        if(err) throw err;\r\n        res.status(200).json(data)\r\n      })\r\n  }\r\n  else{\r\n    res.status(500).json({message:\"Data is not\"})\r\n  }\r\n})\r\n\r\nroutes.post(\"/update-nft-status\",(req, res) => {\r\n  let filterData=models.nftControllerModel.findOne({tokenId: req.body.tokenId});\r\n  filterData.exec((err,data)=>{\r\n    if (err) throw err;\r\n    if(data!==undefined && data!==null){\r\n      let updateNft= models.nftControllerModel.findOneAndUpdate({tokenId: req.body.tokenId},{\r\n        status: req.body.status,\r\n      })\r\n      updateNft.exec((err)=>{\r\n        if(err) throw err;\r\n        res.status(200).json({message:\"Status Updated Successfully\"})\r\n      })\r\n    }\r\n    else{\r\n      res.status(400).json({message:\"Nft not found\"})\r\n    }\r\n})\r\n\r\n})\r\n\r\nroutes.get(\"/count-nft\",(req, res) => {\r\n  models.nftControllerModel.countDocuments({}, function(err, count) {\r\n    res.status(202).json(count)\r\n  })\r\n})\r\n\r\nroutes.post(\"/nft-pagination\",(req, res) => {\r\n  let limitedNft=models.nftControllerModel.find({}).skip((req.body.page-1)*req.body.size).limit(req.body.size);\r\n  models.nftControllerModel.countDocuments({}, function(err, count) {\r\n    let totalPage=Math.ceil(count/req.body.size);\r\n    console.log(totalPage)\r\n    limitedNft.exec((err,data)=>{\r\n      if(err) throw err;\r\n      if(data[0]!==undefined && data[0]!==null){\r\n        res.status(202).json({nft:data,totalPage:totalPage})\r\n      }\r\n    })\r\n  })\r\n})\r\n\r\nroutes.get(\"/feature-nft\",(req, res) => {\r\n  var nftdata=models.nftControllerModel.find({featured: true});\r\n  nftdata.exec()\r\n  .then((data)=>{\r\n    if(data[0]!==undefined && data[0]!==null){\r\n      res.status(200).json(data)\r\n    }\r\n    else{\r\n      res.status(400).json({message:\"No any Nft is featured\"})\r\n    }\r\n  })\r\n  .catch((err)=>console.log(err))\r\n})\r\n\r\nroutes.post(\"/feature-nft\",(req, res) => {\r\n  models.nftControllerModel.countDocuments({featured: true}, function(err, documents) {\r\n    if(documents==10 && req.body.isFeatured==true){\r\n      res.status(202).json({message:\"Feature nft limit exceed\"})\r\n    }\r\n    else if(documents==3 && req.body.isFeatured==false){\r\n      res.status(202).json({message:\"Minimum 3 should be featured\"})\r\n    }\r\n    else{\r\n      let filterData=models.nftControllerModel.findOne({tokenId: req.body.tokenId});\r\n      filterData.exec((err,data)=>{\r\n        if (err) throw err;\r\n        if(data!==undefined && data!==null){\r\n          if(data.status==\"active\"){\r\n            let updateNft= models.nftControllerModel.findOneAndUpdate({tokenId: req.body.tokenId},{\r\n              featured: req.body.isFeatured,\r\n            })\r\n            updateNft.exec((err)=>{\r\n              if(err) throw err;\r\n              res.status(200).json({message:\"Nft Updated Successfully\"})\r\n            })\r\n        }\r\n        else{\r\n          res.status(400).json({message:\"Nft not activated\"})\r\n        }\r\n      }\r\n        else{\r\n          res.status(400).json({message:\"Nft not found\"})\r\n        }\r\n      })\r\n    }\r\n  })\r\n})\r\n\r\nroutes.post(\"/count-nft-category-vise\",(req, res) => {\r\n  if (req.body.category ==undefined && req.body.category == null && req.body.category == false){\r\n    res.status(500).json({message:\"Data is not defined\"})\r\n  }\r\n  else if(req.body.category==\"All NFTs\"){\r\n    models.nftControllerModel.countDocuments({}, function(err, count) {\r\n      res.status(202).json(count)\r\n    })\r\n  }\r\n  else{\r\n    models.nftControllerModel.countDocuments({selectedCat:req.body.category}, function(err, count) {\r\n      res.status(202).json(count)\r\n    })\r\n  }\r\n})\r\n\r\n\r\nroutes.post(\"/nft-category-vise\",(req, res) => {\r\n  if (req.body.category ==undefined && req.body.category == null && req.body.category == false){\r\n    res.status(500).json({message:\"Data is not defined\"})\r\n  }\r\n  else if(req.body.category==\"All NFTs\"){\r\n      let limitedNft=models.nftControllerModel.find().skip((req.body.page-1)*req.body.size).limit(req.body.size);\r\n      models.nftControllerModel.countDocuments({}, function(err, count) {\r\n      let totalPage=Math.ceil(count/req.body.size);\r\n      console.log(totalPage)\r\n      limitedNft.exec((err,data)=>{\r\n        if(err) throw err;\r\n        if(data[0]!==undefined && data[0]!==null){\r\n          res.status(202).json({nft:data,totalPage:totalPage})\r\n        }\r\n        else{\r\n          res.status(500).json({message:\"No NFT found\"})\r\n        }\r\n      })\r\n    })\r\n  }\r\n  else{\r\n      let limitedNft=models.nftControllerModel.find({selectedCat:req.body.category}).skip((req.body.page-1)*req.body.size).limit(req.body.size);\r\n      models.nftControllerModel.countDocuments({selectedCat:req.body.category}, function(err, count) {\r\n        if (err) throw err;\r\n        if(count == undefined || count == null || count == false || count == 0){\r\n          res.status(500).json({message:\"No NFT found for this Category\"})\r\n        }\r\n        else{\r\n          let totalPage=Math.ceil(count/req.body.size);\r\n          console.log(totalPage)\r\n          limitedNft.exec((err,data)=>{\r\n            console.log(data)\r\n            if(err) throw err;\r\n            if(data[0]!==undefined && data[0]!==null){\r\n              res.status(202).json({nft:data,totalPage:totalPage})\r\n            }\r\n            else{\r\n              res.status(500).json({message:\"No NFT found for this Category\"})\r\n            }\r\n          })\r\n        }\r\n      })\r\n    }\r\n})\r\n\r\n\r\n\r\nconst filePath = path.join(__dirname,\"../\",\"../public/sliderimage/\");\r\n\r\n// for file upload\r\nvar Storage=multer.diskStorage({\r\n  destination:filePath,\r\n  filename:(req,file,cb)=>{\r\n    cb(null,uuid.v4()+path.extname(file.originalname))\r\n  }\r\n})\r\n\r\nvar upload=multer({\r\n  storage:Storage\r\n}).single('pic');\r\n \r\n\r\nroutes.post(\"/add_slider\",upload,(req,res)=>{\r\n  if(req.file == undefined){\r\n    res.status(\"400\").json({message:\"Image is Required\"})\r\n  }\r\n  else if(req.body.link == undefined){\r\n    res.status(\"400\").json({message:\"Link is Required\"})\r\n  }\r\n  else{\r\n    models.uploadSliderModel.countDocuments({}, function(err, documents) {\r\n      if(documents==10){\r\n        res.status(202).json({msg:\"slider limit exceed\"})\r\n      }\r\n      else{\r\n      fs.readFile(req.file.path, (err, data) => {\r\n        if (err) throw err;\r\n        const params = {\r\n            Bucket: 'closedsea', // pass your bucket name\r\n            Key: req.file.filename, // file will be saved\r\n            ACL: \"public-read\",\r\n            ContentType: req.file.mimetype,\r\n            Body: data\r\n        };\r\n        s3.upload(params, function(s3Err, data) {\r\n            if (s3Err) throw s3Err\r\n            let uploadslider= new models.uploadSliderModel({\r\n              link: req.body.link,\r\n              imageUrl:data.Location\r\n            })\r\n            uploadslider.save((err)=>{\r\n              if(err) throw err;\r\n              console.log(`File uploaded successfully at ${data.Location}`)\r\n              res.status(200).json({message:\"Success\"})\r\n            })\r\n        });\r\n      });\r\n    }\r\n});\r\n}\r\n});\r\n\r\nroutes.post(\"/update_slider\",upload,(req,res)=>{\r\n  if(req.file == undefined){\r\n    res.status(400).json({message:\"Image is Required\"})\r\n  }\r\n  else if(req.body.link == undefined){\r\n    res.status(400).json({message:\"Link is Required\"})\r\n  }\r\n  else{\r\n  console.log(req.file);\r\n  fs.readFile(req.file.path, (err, data) => {\r\n    if (err) throw err;\r\n    const params = {\r\n        Bucket: 'closedsea', // pass your bucket name\r\n        Key: req.file.filename, // file will be saved as testBucket/contacts.csv\r\n        ACL: \"public-read\",\r\n        ContentType: req.file.mimetype,\r\n        Body: data\r\n    };\r\n    s3.upload(params, function(s3Err, data) {\r\n        if (s3Err) throw s3Err\r\n        let uploadslider= models.uploadSliderModel.findOneAndUpdate({_id:req.body.id},{\r\n          link: req.body.link,\r\n          imageUrl:data.Location\r\n        })\r\n        uploadslider.exec((err)=>{\r\n          if(err) throw err;\r\n          console.log(`File uploaded successfully at ${data.Location}`)\r\n          res.status(200).json({message:\"Success\"})\r\n        })\r\n    });\r\n });\r\n}\r\n});\r\n\r\nroutes.delete(\"/delete_slider/:id\",upload,(req,res)=>{\r\n  let url=req.query.q.split(\".com/\")[1] ;\r\n  var deleteSlider= models.uploadSliderModel.findOneAndDelete({_id:req.params.id});\r\n  s3.deleteObject({\r\n    Bucket: \"closedsea\",\r\n    Key: url\r\n  },function (err,data){\r\n    deleteSlider.exec(function(err){\r\n      if(err) throw err;\r\n      res.status(200).json({message:\"Successfully deleted\"})\r\n  })\r\n  })\r\n});\r\n\r\nroutes.get(\"/getsliders\",(req,res)=>{\r\n  let filterData=models.uploadSliderModel.find();\r\n  filterData.exec(function(err,data){\r\n    if(err) throw err;\r\n    if(data){\r\n      res.status(200).json(data)\r\n    }\r\n  });\r\n})\r\n\r\nroutes.route(\"/search\").get(async (req, res) => {\r\n  try {\r\n    const { name } = req.query;\r\n    console.log(name);\r\n    // const resp = await models.userModel.find({\r\n    //   username: \"OneDabLife \",\r\n    // });\r\n    if(name){\r\n    const collections = await models.collectionModel.find({ name: { $regex:'^' + name, $options: 'i'} });\r\n    const users = await models.userModel.find({ userName: { $regex:'^' + name, $options: 'i'} });\r\n    \r\n    res.status(200).json({\r\n      message: \"success\",\r\n\r\n      data: {\r\n        collections,\r\n        users,\r\n      },\r\n    });}\r\n    else{\r\n      res.status(200).json({\r\n        message: \"success\",\r\n  \r\n        data: {\r\n          collections:\"\",\r\n          users:\"\"\r\n        }\r\n    })\r\n  }\r\n    // const obj = await models.viewAndLikeModel\r\n    //   .findOne({ tokenAddr, tokenId })\r\n    //   .lean()\r\n    //   .exec();\r\n  } catch (error) {\r\n    console.log(\"Search Error => \", error);\r\n    res.status(500).json({ message: error.toString() });\r\n  }\r\n});\r\n\r\nmodule.exports = routes;"],"file":"index.js"}