{"version":3,"file":"middleware.js","names":["CryptoJS","require","secretKey","userAuth","req","res","next","header","setHeader","authApiKey","bytes","AES","decrypt","decryptedData","toString","enc","Utf8","status","json","message"],"sources":["../../src/routes/middleware.js"],"sourcesContent":["var CryptoJS = require(\"crypto-js\");\r\nconst secretKey=\"secretKey=m@_y-se!cre0t-clo_se@ds2ea@123\";\r\n\r\n// var ciphertext = CryptoJS.AES.encrypt('closedSeaAPI', secretKey).toString();\r\n\r\n// console.log(ciphertext)\r\n\r\nexport function userAuth(req, res, next) {\r\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\r\n    res.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS, PUT, PATCH, DELETE');  \r\n    res.header(\"Access-Control-Allow-Headers\", \"Authorization\");\r\n    var authApiKey = req.header('api-key');\r\n    if (authApiKey){\r\n      let bytes;\r\n      bytes =CryptoJS.AES.decrypt(authApiKey, secretKey);\r\n      let decryptedData = bytes.toString(CryptoJS.enc.Utf8)\r\n      // console.log(decryptedData)\r\n      if(decryptedData == \"closedSeaAPI\" || decryptedData == '\"closedSeaAPI\"'){\r\n        next()\r\n      }\r\n      else{\r\n        res.status(400).json({message:\"You are not authorized person\"})\r\n      }\r\n    } \r\n    else{\r\n      res.status(400).json({message:\"You are not authorized person\"})\r\n    }\r\n  };"],"mappings":";;;;;;;AAAA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,WAAD,CAAtB;;AACA,MAAMC,SAAS,GAAC,0CAAhB,C,CAEA;AAEA;;AAEO,SAASC,QAAT,CAAkBC,GAAlB,EAAuBC,GAAvB,EAA4BC,IAA5B,EAAkC;EACrCD,GAAG,CAACE,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;EACAF,GAAG,CAACG,SAAJ,CAAc,8BAAd,EAA8C,wCAA9C;EACAH,GAAG,CAACE,MAAJ,CAAW,8BAAX,EAA2C,eAA3C;EACA,IAAIE,UAAU,GAAGL,GAAG,CAACG,MAAJ,CAAW,SAAX,CAAjB;;EACA,IAAIE,UAAJ,EAAe;IACb,IAAIC,KAAJ;IACAA,KAAK,GAAEV,QAAQ,CAACW,GAAT,CAAaC,OAAb,CAAqBH,UAArB,EAAiCP,SAAjC,CAAP;IACA,IAAIW,aAAa,GAAGH,KAAK,CAACI,QAAN,CAAed,QAAQ,CAACe,GAAT,CAAaC,IAA5B,CAApB,CAHa,CAIb;;IACA,IAAGH,aAAa,IAAI,cAAjB,IAAmCA,aAAa,IAAI,gBAAvD,EAAwE;MACtEP,IAAI;IACL,CAFD,MAGI;MACFD,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;QAACC,OAAO,EAAC;MAAT,CAArB;IACD;EACF,CAXD,MAYI;IACFd,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;MAACC,OAAO,EAAC;IAAT,CAArB;EACD;AACF;;AAAA"}